<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.433">

  <meta name="author" content="Chun-Hao Yang">
  <title>STAT 5010 - Lecture 05: Connections to non-Bayesian Analysis and Hierarchical Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Lecture 05: Connections to non-Bayesian Analysis and Hierarchical Models</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Chun-Hao Yang 
</div>
</div>
</div>

</section>
<section>
<section id="connections-to-non-bayesian-analysis" class="title-slide slide level1 center">
<h1>Connections to non-Bayesian Analysis</h1>
<div class="hidden">
<p><span class="math display">\[
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\E}{\mathbb{E}}
\renewcommand{\P}{\mathbb{P}}
\newcommand{\var}{{\rm Var}} % Variance
\newcommand{\mse}{{\rm MSE}} % MSE
\newcommand{\bias}{{\rm Bias}} % MSE
\newcommand{\cov}{{\rm Cov}} % Covariance
\newcommand{\iid}{\stackrel{\rm iid}{\sim}}
\newcommand{\ind}{\stackrel{\rm ind}{\sim}}
\renewcommand{\choose}[2]{\binom{#1}{#2}}  % Choose
\newcommand{\chooses}[2]{{}_{#1}C_{#2}}  % Small choose
\newcommand{\cd}{\stackrel{d}{\rightarrow}}
\newcommand{\cas}{\stackrel{a.s.}{\rightarrow}}
\newcommand{\cp}{\stackrel{p}{\rightarrow}}
\newcommand{\bin}{{\rm Bin}}
\newcommand{\ber}{{\rm Ber}}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\]</span></p>
</div>
</section>
<section id="introduction" class="slide level2">
<h2>Introduction</h2>
<ul>
<li class="fragment">In the previous lecture, we saw that MLE and MAP are related.</li>
<li class="fragment">We will discuss this relationship in more details and explore how this relationship benefits us.</li>
<li class="fragment">MLE and MAP are not the only connection between Bayesian and non-Bayesian analysis.</li>
<li class="fragment">We will discuss two other examples: bootstrap and random effect model.</li>
</ul>
</section>
<section id="mle-vs-map" class="slide level2">
<h2>MLE vs MAP</h2>
<div class="fragment">
<ul>
<li>Given <span class="math inline">\(X_1, \ldots, X_n \iid f(x\mid\theta)\)</span>, the likelihood function is</li>
</ul>
<p><span class="math display">\[\ell(\theta\mid x_1,\ldots,x_n) = \prod_{i=1}^n f(x_i\mid\theta) = f(x_1,\ldots,x_n\mid\theta).\]</span></p>
</div>
<div class="fragment">
<ul>
<li>Suppose we choose <span class="math inline">\(\pi(\theta) \propto 1\)</span>. The posterior is<sup>1</sup></li>
</ul>
<p><span class="math display">\[
    \pi(\theta \mid x_1, \ldots, x_n) \propto f(x_1,\ldots,x_n\mid\theta)\pi(\theta) = f(x_1,\ldots,x_n\mid\theta).
\]</span></p>
</div>
<div class="fragment">
<ul>
<li>Therefore</li>
</ul>
<p><span class="math display">\[
\hat{\theta}_{\text{MAP}} = \argmax_{\theta}\pi(\theta \mid x_1, \ldots, x_n)
    = \argmax_{\theta}\ell(\theta\mid x_1,\ldots,x_n) = \hat{\theta}_{\text{MLE}}.
\]</span></p>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>We need to make sure that the posterior is proper; otherwise, this equation is meaningless.</p></li></ol></aside></section>
<section id="asymptotics-of-mle" class="slide level2">
<h2>Asymptotics of MLE</h2>
<ul>
<li class="fragment">Let <span class="math inline">\(X_1, \ldots, X_n \iid f(x\mid \theta)\)</span> and <span class="math inline">\(\hat{\theta}_n\)</span> be the MLE of <span class="math inline">\(\theta\)</span>.</li>
<li class="fragment">Under some regularity conditions on <span class="math inline">\(f(x\mid\theta)\)</span>, the MLE is asymptotically normally distributed and efficient (having the smallest variance).</li>
<li class="fragment">That is, <span class="math display">\[
\sqrt{n}\left(\hat{\theta}_n-\theta\right) \stackrel{d}{\rightarrow} N\left(0, I(\theta)^{-1}\right)
\]</span> where <span class="math inline">\(I(\theta)\)</span> is the Fisher information of <span class="math inline">\(f(x\mid\theta)\)</span>.</li>
<li class="fragment">An important application of this result is the approximate confidence interval for <span class="math inline">\(\theta\)</span> <span class="math display">\[
\P\left(\hat{\theta}_n - z_{\alpha/2}[nI(\hat{\theta}_n)]^{-1/2} \leq \theta \leq \hat{\theta}_n + z_{\alpha/2}[nI(\hat{\theta}_n)]^{-1/2} \right) \approx \alpha.
\]</span></li>
</ul>
</section>
<section id="asymptotics-of-bayesian-inference" class="slide level2">
<h2>Asymptotics of Bayesian inference</h2>
<ul>
<li class="fragment">The Bernstein-von Mises Theorem states that under some regularity conditions, the posterior distribution is asymptotically normal centered at the MLE.</li>
<li class="fragment">See Section 10.2 of Van der Vaart (2000) for rigorous arguments.</li>
<li class="fragment">The regularity conditions include:
<ul>
<li class="fragment">the posterior must be proper, and</li>
<li class="fragment">the prior is (strictly) positive in a neighborhood around the true parameter (this is a strong condition in high dimensions), etc.</li>
</ul></li>
<li class="fragment">Roughly speaking, the Bernstein-von Mises theorem works well on a problem with few parameters and large dataset containing iid samples. For complicated problems, it is not as useful as you expect<sup>1</sup>.</li>
</ul>

<aside><div>
<p>Van der Vaart, A. W. (2000). <em>Asymptotic statistics</em>.</p>
</div><ol class="aside-footnotes"><li id="fn2"><p>See this <a href="https://statmodeling.stat.columbia.edu/2017/11/27/asymptotically-we-are-all-dead/">blog post</a> for an interesting discussion on Bernstein-von Mises Theoerm.</p></li></ol></aside></section>
<section id="normal-approximation-to-the-posterior" class="slide level2">
<h2>Normal approximation to the posterior</h2>
<ul>
<li class="fragment">If the posterior <span class="math inline">\(\pi(\theta\mid x)\)</span> is <u>unimodal and roughly symmetric</u>, it can be convenient to approximate it by a normal distribution.</li>
<li class="fragment">That is, the logarithm of the posterior density is approximated by a quadratic function of <span class="math inline">\(\theta\)</span>.</li>
<li class="fragment">Consider Taylor series expansion of <span class="math inline">\(\log \pi(\theta\mid x)\)</span> centered at the posterior mode (MAP) <span class="math inline">\(\hat{\theta}\)</span> <span class="math display">\[
\log \pi(\theta \mid x)=\log \pi(\hat{\theta} \mid x)+\frac{1}{2}(\theta-\hat{\theta})^T\left[\frac{d^2}{d \theta^2} \log \pi(\theta \mid x)\right]_{\theta=\hat{\theta}}(\theta-\hat{\theta})+\cdots
\]</span></li>
<li class="fragment">That is, <span class="math display">\[\begin{align*}
\pi(\theta \mid x) \approx N\left(\hat{\theta},[I(\hat{\theta})]^{-1}\right)
\end{align*}\]</span> where <span class="math inline">\(I(\theta)\)</span> is the observed information, <span class="math inline">\(I(\theta)=-\frac{d^2}{d \theta^2} \log \pi(\theta \mid x)\)</span>.</li>
</ul>
</section>
<section id="normal-approximation-to-the-posterior-1" class="slide level2">
<h2>Normal approximation to the posterior</h2>
<ul>
<li class="fragment">If the approximation is good, we can construct an approximate credible interval without resorting to sampling techniques.</li>
<li class="fragment">In practice, however, it is almost impossible to check how good or bad the approximation is, especially when the parameter is high-dimensional.</li>
<li class="fragment">Even for low-dimensional parameter, if the posterior is multi-modal, the normal approximation will be terrible.</li>
<li class="fragment">In a later lecture, we will introduce a technique, called <strong>variational inference</strong>, which allows us to approximate the posterior using any parametric family, not just normal.</li>
</ul>
</section>
<section id="bootstrap-and-bayesian-inference2" class="slide level2">
<h2>Bootstrap and Bayesian Inference<sup>1</sup></h2>
<ul>
<li class="fragment">Bootstrap is a method proposed by Efron (1979)<sup>2</sup> for deriving the sampling distribution of a statistic.</li>
<li class="fragment">It is based on resampling from the empirical distribution, which converges to the true population distribution (Glivenko-Cantelli theorem).</li>
<li class="fragment">Example: <span class="math inline">\(X_1, \ldots, X_n \iid F\)</span> and <span class="math inline">\(\bar{X}_n = \frac{1}{n}\sum_{i=1}^n X_i\)</span>.</li>
<li class="fragment">A bootstrap sample <span class="math inline">\(X_1^*, \ldots, X_n^*\)</span> is obtained from <span class="math inline">\(X_1, \ldots, X_n\)</span> using <u>sampling with replacement</u>.</li>
<li class="fragment">The sampling distribution of <span class="math inline">\(\bar{X}_n\)</span> can be estimated/approximated by the distribution of <span class="math inline">\(\bar{X}^*_n = \frac{1}{n}\sum_{i=1}^n X_i^*\)</span>, which is called the <strong>bootstrap distribution</strong>.</li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn3"><p>Ch. 8.4 in Hastie, T., Tibshirani, R., Friedman, J. H., &amp; Friedman, J. H. (2009). <em>The elements of statistical learning: data mining, inference, and prediction</em>.</p></li><li id="fn4"><p>B. Efron. (1979) Bootstrap Methods: Another Look at the Jackknife. <em>Annals of Statistics</em> 7(1) 1 - 26.</p></li></ol></aside></section>
<section id="bootstrap-and-bayesian-inference" class="slide level2">
<h2>Bootstrap and Bayesian Inference</h2>
<ul>
<li class="fragment">There are some similarities between bootstrap and Bayesian inference:
<ol type="1">
<li class="fragment">They both treat the sample as fixed and given.</li>
<li class="fragment">Based on the sample, they both construct a distribution: bootstrap distribution vs posterior distribution.</li>
</ol></li>
<li class="fragment">When will they be (approximately) the same?</li>
<li class="fragment">Suppose <span class="math inline">\(X_1, \ldots, X_n \mid p \iid \text{Ber}(p)\)</span> and <span class="math inline">\(p \sim \text{Beta}(\alpha, \beta)\)</span>. Then <span class="math display">\[
p \sim \text{Beta}\left(\alpha + \sum X_i, \beta + n - \sum X_i\right).
\]</span></li>
<li class="fragment">Letting <span class="math inline">\(\alpha \to 0\)</span> and <span class="math inline">\(\beta \to 0\)</span>, we have a noninformative prior and <span class="math display">\[
p \mid X_1,\ldots, X_n \sim \text{Beta}\left(\sum X_i, n-\sum X_i\right).
\]</span></li>
</ul>
</section>
<section id="bootstrap-and-bayesian-inference-1" class="slide level2">
<h2>Bootstrap and Bayesian Inference</h2>
<ul>
<li class="fragment">Consider a bootstrap sample <span class="math inline">\(X_1^*, \ldots, X_n^*\)</span> (obtained from <span class="math inline">\(X_1,\ldots,X_n\)</span> using sampling with replacement).</li>
<li class="fragment">Actually, <span class="math inline">\(X_1^*,\ldots, X_n^*\mid X_1,\ldots, X_n \iid \text{Ber}(\hat{p})\)</span>, where <span class="math inline">\(\hat{p} = \frac{1}{n}\sum X_i\)</span>.</li>
<li class="fragment">Let <span class="math inline">\(\hat{p}^* = \frac{1}{n}\sum X_i^*\)</span>. What is the <u>bootstrap distribution</u> <span class="math inline">\(\hat{p}^* \mid X_1,\ldots, X_n\)</span>?</li>
<li class="fragment">Let’s do some experiment!</li>
</ul>
</section>
<section id="bootstrap-and-bayesian-inference-2" class="slide level2">
<h2>Bootstrap and Bayesian Inference</h2>
<div class="cell" data-hash="05-hierarchical_model_cache/revealjs/binomial_bootstrap_9050daada72740a8929212c8f2d4adfc">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">set.seed</span>(<span class="dv">124</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>p <span class="ot">&lt;-</span> <span class="fl">0.4</span>; n <span class="ot">&lt;-</span> <span class="dv">100</span>; X <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p)</span>
<span id="cb1-3"><a href="#cb1-3"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># bootstrap</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>p_boot <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, B)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb1-9"><a href="#cb1-9"></a>    X_boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(X, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a>    p_boot[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_boot)</span>
<span id="cb1-11"><a href="#cb1-11"></a>}</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">hist</span>(p_boot, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">"Bootstrap Distribution"</span>, <span class="at">xlab =</span> <span class="st">"p"</span>)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, n<span class="sc">*</span>p_hat, n<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_hat)), <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">abline</span>(<span class="at">v =</span> p, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">abline</span>(<span class="at">v =</span> p_hat, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="bootstrap-and-bayesian-inference-2-output" class="slide level2 output-location-slide"><h2>Bootstrap and Bayesian Inference</h2><div class="cell output-location-slide" data-hash="05-hierarchical_model_cache/revealjs/binomial_bootstrap_9050daada72740a8929212c8f2d4adfc">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="05-hierarchical_model_files/figure-revealjs/binomial_bootstrap-1.png" width="960"></p>
<figcaption>The red curve is the posterior distribution; the blue dashed line is the MLE.</figcaption>
</figure>
</div>
</div>
</div></section><section id="bootstrap-and-bayesian-inference-3" class="slide level2">
<h2>Bootstrap and Bayesian Inference</h2>
<ul>
<li class="fragment">In this sense, the bootstrap distribution represents an (approximate) nonparametric posterior distribution under a noninformative prior.</li>
<li class="fragment">But this bootstrap distribution is obtained painlessly – without having to formally specify a prior and without having to sample from the posterior distribution.</li>
<li class="fragment">Hence we might think of the bootstrap distribution as a “poor man’s” posterior.</li>
</ul>
</section>
<section id="distributional-estimates" class="slide level2">
<h2>Distributional estimates</h2>
<ul>
<li class="fragment">One of the advantages of Bayesian inference is that the entire inference is based the posterior distribution, rather than a single point estimate or an interval.</li>
<li class="fragment">The posterior distribution is just one example of <strong>distributional estimate</strong>, which use a distribution for inference.</li>
<li class="fragment">Bootstrap distribution is another example.</li>
<li class="fragment">There is a frequentist concept, called the <strong>confidence distribution</strong>, proposed by Neyman (1939)<sup>1</sup>.</li>
<li class="fragment">The confidence distribution contains confidence interval of any level.</li>
<li class="fragment">Fraser (2011)<sup>2</sup> also discussed how the Bayesian posterior and the confidence distribution are related.</li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn5"><p>Neyman, J. (1937). Outline of a theory of statistical estimation based on the classical theory of probability. <em>Phil. Trans. Roy. Soc</em></p></li><li id="fn6"><p>Fraser, D. A. S. (2011). Is Bayes Posterior just Quick and Dirty Confidence? <em>Statistical Science</em>, 26(3), 299–316.</p></li></ol></aside></section>
<section id="random-effect-models" class="slide level2">
<h2>Random effect models</h2>
<ul>
<li class="fragment">Fixed effect model: <span class="math inline">\(Y_i = \beta_0 + \beta X_i + \varepsilon_i\)</span>, <span class="math inline">\(\varepsilon_i \iid N(0, \sigma^2)\)</span>
<ul>
<li class="fragment">The parameter <span class="math inline">\(\beta\)</span> is the <strong>fixed effect</strong> of the factors <span class="math inline">\(X\)</span>.</li>
<li class="fragment">With a unit increase in <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> is expected to increase by <span class="math inline">\(\beta\)</span>.</li>
<li class="fragment">Use (regularized) least squares to obtain an estimate for <span class="math inline">\(\beta\)</span>.</li>
<li class="fragment">The effect is <u>the same for each observation</u></li>
</ul></li>
<li class="fragment">Random effect model: <span class="math inline">\(Y_i = \beta_0 + U_i + \varepsilon_i\)</span>, <span class="math inline">\(U_i \sim N(\beta, \tau^2)\)</span>, <span class="math inline">\(\varepsilon_i \iid N(0, \sigma^2)\)</span>
<ul>
<li class="fragment"><span class="math inline">\(U_i\)</span> is the <strong>random effect</strong> in this model</li>
<li class="fragment">The effect is different for each observation and, on average, <span class="math inline">\(Y\)</span> is increase by <span class="math inline">\(\beta\)</span> with the presence of this effect.</li>
</ul></li>
</ul>
</section>
<section id="mixed-effect-model" class="slide level2">
<h2>Mixed effect model</h2>
<ul>
<li class="fragment">A model with both fixed effects and random effects is called a <strong>mixed effect model</strong>.</li>
<li class="fragment">This model is commonly used in biostatistics, psychology, economics, etc.</li>
<li class="fragment">A typical mixed effect model: <span class="math display">\[
Y = X\beta + Z\gamma + \varepsilon, \quad \varepsilon \sim N(0, \sigma^2)  
\]</span> where <span class="math inline">\(\beta\)</span> is the unknown fixed effect and <span class="math inline">\(\gamma \sim N(\nu, \Psi)\)</span> is the unknown random effect.</li>
</ul>
</section></section>
<section>
<section id="sleep-deprivation-study" class="title-slide slide level1 center">
<h1>Sleep deprivation study</h1>

</section>
<section id="data-description" class="slide level2">
<h2>Data description</h2>
<p>We use the <code>sleepstudy</code> dataset in the <code>lme4</code> R package.</p>
<blockquote>
<p>This dataset contains the average reaction time per day (in milliseconds) for subjects in a sleep deprivation study described in Belenky et al.&nbsp;(2003)<sup>1</sup>, for the most sleep-deprived group (3 hours time-in-bed; 18 subjects) and for the first 10 days of the study. Days 0-1 were adaptation and training (T1/T2), and day 2 was baseline (B); sleep deprivation started after day 2.</p>
</blockquote>
<aside><ol class="aside-footnotes"><li id="fn7"><p>Gregory Belenky, Nancy J. Wesensten, David R. Thorne, Maria L. Thomas, Helen C. Sing, Daniel P. Redmond, Michael B. Russo and Thomas J. Balkin (2003) Patterns of performance degradation and restoration during sleep restriction and subsequent recovery: a sleep dose-response study. <em>Journal of Sleep Research</em> <strong>12</strong>, 1–12.</p></li></ol></aside></section>
<section id="data-description-1" class="slide level2">
<h2>Data description</h2>
<div class="cell" data-hash="05-hierarchical_model_cache/revealjs/sleep_data_5868c2ddc99a0af06b517038ca416135">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">data</span>(<span class="st">"sleepstudy"</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>sleepstudy <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">kbl</span>(<span class="at">format=</span><span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Reaction</th>
<th style="text-align: right;">Days</th>
<th style="text-align: left;">Subject</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">249.5600</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">308</td>
</tr>
<tr class="even">
<td style="text-align: right;">258.7047</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">308</td>
</tr>
<tr class="odd">
<td style="text-align: right;">250.8006</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">308</td>
</tr>
<tr class="even">
<td style="text-align: right;">321.4398</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">308</td>
</tr>
<tr class="odd">
<td style="text-align: right;">356.8519</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">308</td>
</tr>
<tr class="even">
<td style="text-align: right;">414.6901</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">308</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="first-attempt-simple-linear-regression" class="slide level2">
<h2>First attempt: simple linear regression</h2>
<ul>
<li class="fragment">Let <span class="math inline">\(Y\)</span> be the reaction time and <span class="math inline">\(X\)</span> be the Day variable.</li>
<li class="fragment">We want to see the negative impact of consecutive sleep loss in reaction time.</li>
<li class="fragment">A simple linear model: <span class="math inline">\(Y = \beta_0 + \beta_1 X\)</span>.</li>
</ul>
<div class="fragment">
<div class="cell" data-hash="05-hierarchical_model_cache/revealjs/sleep_lm_246c30673b1d341e9d8f71118179b200">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb3-2"><a href="#cb3-2"></a>sleepstudy <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="fu">lm</span>(Reaction <span class="sc">~</span> Days, <span class="at">data =</span> ., <span class="at">subset=</span>Days<span class="sc">&gt;=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4"></a>    <span class="fu">tab_model</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" style="border-collapse:collapse; border:none;">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Reaction</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">245.10</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">223.31&nbsp;–&nbsp;266.88</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Days</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">11.44</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">7.78&nbsp;–&nbsp;15.09</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">144</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.212 / 0.207</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="individual-difference" class="slide level2">
<h2>Individual difference</h2>
<p>However, this model does not take into account the individual difference, i.e., the difference between subjects.</p>

<img data-src="05-hierarchical_model_files/figure-revealjs/sleep_plot-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="second-attempt-mixed-effect-model" class="slide level2">
<h2>Second attempt: Mixed effect model</h2>
<ul>
<li class="fragment">We allow each subject to have its own intercept and effect: <span class="math display">\[
    Y_{ij} = b_{0,i} + b_{1,i} X_{j}, \quad i = 1,\ldots, 18, j = 0,\ldots, 9
\]</span> where <span class="math inline">\(Y_{ij}\)</span> is the reaction time of <span class="math inline">\(i\)</span>th subject in Day <span class="math inline">\(j\)</span>.</li>
<li class="fragment">Note that we are not interested in the effects for each individuals.</li>
<li class="fragment">We just want to identify how much the individual difference contributes to the un-explained variation of the model.</li>
<li class="fragment">We assume that <span class="math inline">\(b_{0,i} \iid N(\beta_0, \tau_0^2)\)</span> and <span class="math inline">\(b_{1,i} \iid N(\beta_1, \tau_1^2)\)</span> are independent.</li>
<li class="fragment">The frequentist interpretation of this assumption is that the subjects are randomly selected, so there is randomness in the individual coefficients.</li>
<li class="fragment">The parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are unknown and fixed.</li>
</ul>
</section>
<section id="second-attempt-mixed-effect-model-1" class="slide level2">
<h2>Second attempt: Mixed effect model</h2>
<div class="cell" data-hash="05-hierarchical_model_cache/revealjs/sleep_lmer_549f33975615e094fe8cb01e239b957f">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>sleepstudy <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="fu">lmer</span>(Reaction <span class="sc">~</span> Days <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject) <span class="sc">+</span> (<span class="dv">0</span><span class="sc">+</span>Days<span class="sc">|</span>Subject), </span>
<span id="cb4-3"><a href="#cb4-3"></a>         <span class="at">data =</span> ., <span class="at">subset=</span>Days<span class="sc">&gt;=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="fu">tab_model</span>(<span class="at">show.icc =</span> <span class="cn">FALSE</span>,<span class="at">show.obs =</span> <span class="cn">FALSE</span>, <span class="at">show.ngroups =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Reaction</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">245.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">227.71&nbsp;–&nbsp;262.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Days</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">11.44</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">7.97&nbsp;–&nbsp;14.90</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">662.92</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">831.93</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub> <sub>Subject.Days</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">39.50</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">&nbsp;</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">0.316 / 0.697</td>
</tr>

</tbody></table>

</div>
</div>
</section>
<section id="bayesian-approach-to-mixed-effect-models" class="slide level2">
<h2>Bayesian approach to mixed effect models</h2>
<ul>
<li class="fragment">The random effect assumption looks like a prior distribution on the coefficients.</li>
<li class="fragment">A mixed model <span class="math display">\[
Y = X\beta + Z\gamma + \varepsilon, \quad\gamma \sim N(\nu, \Psi), \varepsilon \sim N(0, \sigma^2)  
\]</span> can be rewritten as <span class="math display">\[\begin{align*}
    Y \mid \gamma &amp; \sim N(X\beta + Z\gamma, \sigma^2)\\
    \gamma &amp; \sim N(\nu, \Psi)
\end{align*}\]</span></li>
<li class="fragment">A Bayesian approach puts priors on the parameters: <span class="math display">\[\begin{align*}
    Y \mid \gamma, \beta, \sigma^2 &amp; \sim N(X\beta + Z\gamma, \sigma^2)\\
    \gamma \mid \nu, \Psi &amp; \sim N(\nu, \Psi)\\
    \beta, \nu, \sigma^2, \Psi &amp; \sim \pi(\beta, \nu, \sigma^2, \Psi)
\end{align*}\]</span></li>
</ul>
</section>
<section id="bayesian-approach-to-mixed-effect-models-1" class="slide level2">
<h2>Bayesian approach to mixed effect models</h2>
<p>Use <code>stan_lmer</code> to fit a Bayesian mixed effect model</p>
<div class="cell" data-hash="05-hierarchical_model_cache/revealjs/sleep_Bayes_lmer_e742b3881ea764309b4d4c5c858eafd9">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb5-2"><a href="#cb5-2"></a>sleep_lmer_B <span class="ot">&lt;-</span> <span class="fu">stan_lmer</span>(Reaction <span class="sc">~</span> Days <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject) <span class="sc">+</span> (<span class="dv">0</span><span class="sc">+</span>Days<span class="sc">|</span>Subject), </span>
<span id="cb5-3"><a href="#cb5-3"></a>                          <span class="at">data =</span> sleepstudy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li class="fragment">Use <code>summary(sleep_lmer_B)</code> to check the fitted result</li>
<li class="fragment">Use <code>prior_summary(sleep_lmer_B)</code> to check the priors used in the model</li>
</ul>
</section>
<section id="wrap-up" class="slide level2">
<h2>Wrap-up</h2>
<ul>
<li class="fragment">Random effects are also called <strong>variance components</strong>, since we are more interested in the variance of the random effect rather than the effect itself.</li>
<li class="fragment">Mixed effect model is just one example of <strong>hierarchical models</strong> (or <strong>multi-level models</strong>).</li>
<li class="fragment">A hierarchical model contains many sub-models that are linked by some hierarchical relations.</li>
<li class="fragment">In the previous example, we can partition the dataset into smaller pieces by subject and hence subject is a hierarchy in this dataset.</li>
<li class="fragment">Note that a hierarchical model need not be a Bayesian model. However, Bayesian approach is the easiest and most natural way to fit a hierarchical model.</li>
</ul>
</section></section>
<section>
<section id="hierarchical-models" class="title-slide slide level1 center">
<h1>Hierarchical Models</h1>

</section>
<section id="motivation" class="slide level2">
<h2>Motivation</h2>
<ul>
<li class="fragment">Some problems have intrinsic hierarchical structures, e.g., samples are grouped by some covariates (gender, ethnicity, etc.).</li>
<li class="fragment">In practice, simple nonhierarchical models are usually inappropriate for hierarchical data: with few parameters, they generally cannot fit large datasets accurately, whereas with many parameters, they tend to ‘overfit’.</li>
<li class="fragment">When parameters are only exchangeable rather than independent, a <em>hyperprior</em> is needed (de Finetti’s Theorem). That is, the subscripts of the parameters convey no information.</li>
</ul>
</section>
<section id="meta-analysis" class="slide level2">
<h2>Meta-analysis</h2>
<ul>
<li class="fragment"><p>Meta-analysis is an increasingly popular and important process of summarizing and integrating the findings of research studies in a particular area.</p></li>
<li class="fragment"><p>The article “Why Science Is Not Necessarily Self-Correcting” by Ioannidis (2012) pointed out that sometimes fundamental fallacies remain unchallenged and are only perpetuated.</p></li>
<li class="fragment"><p>You can find a detailed introduction to meat-analysis and different approaches to meta-analysis in <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/" class="uri">https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/</a>.</p></li>
</ul>

<aside><div>
<p>Ioannidis, J. P. (2012). Why science is not necessarily self-correcting. <em>Perspectives on Psychological Science</em>, 7(6), 645-654.</p>
</div></aside></section></section>
<section>
<section id="clinical-trials-of-beta-blockers" class="title-slide slide level1 center">
<h1>Clinical trials of beta-blockers</h1>

</section>
<section id="data-description-2" class="slide level2">
<h2>Data description</h2>
<ul>
<li class="fragment">Beta-blocker is a family of drugs that affect the central nervous system and can relax the heart muscles.</li>
<li class="fragment">This dataset summarizes mortality after myocardial infarction in 22 clinical trials.</li>
<li class="fragment">Each clinical trial consists of two groups of heart attack patients randomly allocated to receive or not receive beta-blockers.</li>
<li class="fragment">The dataset is available at <a href="http://www.stat.columbia.edu/~gelman/book/data/meta.asc" class="uri">http://www.stat.columbia.edu/~gelman/book/data/meta.asc</a>.</li>
<li class="fragment">The aim of a meta-analysis is to provide a combined analysis of the studies that indicates the overall strength of the evidence for a beneficial effect of the treatment under study.</li>
</ul>
</section>
<section id="data-description-3" class="slide level2">
<h2>Data description</h2>
<div class="cell" data-hash="05-hierarchical_model_cache/revealjs/meta_data_c4535061f130f0f7c8e5410292763526">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"http://www.stat.columbia.edu/~gelman/book/data/meta.asc"</span>, </span>
<span id="cb6-2"><a href="#cb6-2"></a>                  <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>meta <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">study</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">control.deaths</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">control.total</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">treated.deaths</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">treated.total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">114</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">69</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">1520</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">1533</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">365</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">355</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">59</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="odds-ratio" class="slide level2">
<h2>Odds ratio</h2>
<ul>
<li class="fragment">The odds ratio is the ratio of the odds death in the treatment group and the odds of death in the control group <span class="math display">\[
\rho = \left. \frac{p_{\text{treat}}}{1-p_{\text{treat}}} \middle/ \frac{p_{\text{con}}}{1-p_{\text{con}}} \right. .
\]</span></li>
<li class="fragment">We concentrate the inference on the log of the odds ratios <span class="math inline">\(\theta = \log \rho\)</span> for each clinical trial.</li>
</ul>
</section>
<section id="normal-approximation-to-the-likelihood" class="slide level2">
<h2>Normal approximation to the likelihood</h2>
<ul>
<li class="fragment">Let <span class="math inline">\(y_{ij}\)</span> and <span class="math inline">\(n_{ij}\)</span> be the number of deaths and subjects of the <span class="math inline">\(i\)</span>th group (<span class="math inline">\(1=\)</span> treated, <span class="math inline">\(0 =\)</span> control) in study <span class="math inline">\(j\)</span>.</li>
<li class="fragment">For each study <span class="math inline">\(j\)</span>, we estimate <span class="math inline">\(\theta_j\)</span> by <span class="math display">\[
\hat{\theta}_j=\log \left(\frac{y_{1 j}}{n_{1 j}-y_{1 j}}\right)-\log \left(\frac{y_{0 j}}{n_{0 j}-y_{0 j}}\right),
\]</span> with approximate sampling variance <span class="math display">\[
\sigma_j^2=\frac{1}{y_{1 j}}+\frac{1}{n_{1 j}-y_{1 j}}+\frac{1}{y_{0 j}}+\frac{1}{n_{0 j}-y_{0 j}}.
\]</span></li>
<li class="fragment">Thus <span class="math inline">\(\hat{\theta}_j \sim N(\theta_j, \sigma_j^2)\)</span> approximately.</li>
</ul>
</section>
<section id="odds-ratio-1" class="slide level2">
<h2>Odds ratio</h2>
<div class="cell" data-hash="05-hierarchical_model_cache/revealjs/meta_odds_ratio_66041436bc44a5e07ad3db486ceee59b">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>meta_summary <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="fu">mutate</span>(<span class="at">treated.odds =</span> treated.deaths<span class="sc">/</span>(treated.total <span class="sc">-</span> treated.deaths),</span>
<span id="cb7-3"><a href="#cb7-3"></a>           <span class="at">control.odds =</span> control.deaths<span class="sc">/</span>(control.total <span class="sc">-</span> control.deaths),</span>
<span id="cb7-4"><a href="#cb7-4"></a>           <span class="at">log.odds.ratio =</span> <span class="fu">log</span>(treated.odds) <span class="sc">-</span> <span class="fu">log</span>(control.odds), </span>
<span id="cb7-5"><a href="#cb7-5"></a>           <span class="at">var =</span> <span class="dv">1</span><span class="sc">/</span>treated.deaths <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>(treated.total <span class="sc">-</span> treated.deaths) <span class="sc">+</span> </span>
<span id="cb7-6"><a href="#cb7-6"></a>               <span class="dv">1</span><span class="sc">/</span>control.deaths <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>(control.total <span class="sc">-</span> control.deaths)) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="fu">select</span>(<span class="fu">c</span>(study, log.odds.ratio, var)) </span>
<span id="cb7-8"><a href="#cb7-8"></a>meta_summary <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">study</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">log.odds.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0282</td>
<td style="text-align: right;">0.7230</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-0.7410</td>
<td style="text-align: right;">0.2334</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-0.5406</td>
<td style="text-align: right;">0.3187</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.2461</td>
<td style="text-align: right;">0.0191</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0695</td>
<td style="text-align: right;">0.0788</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">-0.5842</td>
<td style="text-align: right;">0.4566</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="goal-of-the-inference" class="slide level2">
<h2>Goal of the inference</h2>
<ul>
<li class="fragment">Now we have the log odds ratios and their sampling variances from 22 studies.</li>
<li class="fragment">How are these studies related to each other?
<ul>
<li class="fragment">Are they identical replications of each other, i.e., the studies are independent samples from a common population?</li>
<li class="fragment">Are they completely unrelated?</li>
</ul></li>
<li class="fragment">A more realistic assumption is that they are somewhere between the two extremes.</li>
<li class="fragment"><u>Exchangeablity assumption</u>: the parameters <span class="math inline">\(\theta_j\)</span> are exchangeable.
<ul>
<li class="fragment">We cannot distinguish <span class="math inline">\(\theta_j\)</span>’s before we see that data.</li>
<li class="fragment">Therefore <span class="math display">\[
(\theta_1, \ldots, \theta_{22}) \sim \pi \Leftrightarrow
\theta_i \iid \pi(\theta\mid\phi), \phi \sim \nu.
\]</span></li>
</ul></li>
</ul>
</section>
<section id="a-hierarchical-model" class="slide level2">
<h2>A hierarchical model</h2>
<ul>
<li class="fragment">Likelihood: <span class="math inline">\(\hat{\theta}_j \sim N(\theta_j, \sigma^2_j)\)</span>, <span class="math inline">\(j = 1,\ldots, 22\)</span>.
<ul>
<li class="fragment">Assume the <span class="math inline">\(\sigma^2_j\)</span>’s are known (given by the sampling variance computed before).</li>
</ul></li>
<li class="fragment">Prior: we use the exchangeable normal prior for <span class="math inline">\(\theta_j\)</span>, <span class="math display">\[
\theta_j \mid \mu, \tau \iid N(\mu, \tau^2)
\]</span> where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau\)</span> are unknown <em>hyperparameters</em>.</li>
<li class="fragment">Hyperprior: for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau\)</span> <span class="math display">\[\begin{align*}
\mu &amp; \sim \pi(\mu) \propto 1\\
\tau &amp; \sim \text{Unif}(0, A)
\end{align*}\]</span> for some large <span class="math inline">\(A\)</span>.</li>
<li class="fragment">Computation is left as homework.</li>
</ul>
</section>
<section id="weakly-informative-priors-for-variance-parameters" class="slide level2">
<h2>Weakly informative priors for variance parameters</h2>
<ul>
<li class="fragment">For the variance parameter <span class="math inline">\(\tau\)</span>, we use the uniform prior <span class="math inline">\(\text{Unif}(0, A)\)</span>, which is a proper noninformative prior.</li>
<li class="fragment">Another choice is Inverse-Gamma<span class="math inline">\((\epsilon, \epsilon)\)</span>, with small <span class="math inline">\(\epsilon\)</span>.</li>
<li class="fragment">How about the Jeffreys prior?
<ul>
<li class="fragment">To compute the Jeffreys prior, you need to first find the marginal distribution <span class="math inline">\(f(x\mid \mu, \tau) = \int f(x \mid \theta) \pi(\theta \mid \mu, \tau) d\mu\)</span>.</li>
<li class="fragment">Then compute the Fisher information of <span class="math inline">\(f(x \mid \mu, \tau)\)</span>.</li>
<li class="fragment">Both steps are difficult!!</li>
</ul></li>
<li class="fragment">A bad news is that the posterior of <span class="math inline">\(\tau\)</span> is sensitive to the choice of prior. You will see this in your homework.</li>
<li class="fragment">Read Section 5.7 of BDA for more details.</li>
</ul>

<div class="footer footer-default">
<p><a href="https://chunhaoy.com/stat-5010/">Home</a></p>
</div>
</section></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>